"use strict";
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.Util = void 0;
const JSII_RTTI_SYMBOL_1 = Symbol.for("jsii.rtti");
const core_1 = require("../core");
/**
 * Utility class for mathematical operations.
 */
class Util {
    /**
     * @internal
     */
    static _toInflightType() {
        return core_1.InflightClient.forType(__filename, this.name);
    }
    /**
     * Checks if a number is prime.
     * @param n The number to check for primality.
     */
    static isPrime(n) {
        if (n <= 1) {
            return false;
        }
        for (let i = 2; i <= Math.sqrt(n); i++) {
            if (n % i === 0) {
                return false;
            }
        }
        return true;
    }
    /**
     * Returns the absolute value of a number.
     * @param value The input number.
     */
    static abs(value) {
        return Math.abs(value);
    }
    /**
     * Calculates the median value of an array of numbers.
     * @param arr - The array of numbers.
     */
    static median(arr) {
        const mid = Math.floor(arr.length / 2);
        const nums = [...arr].sort((a, b) => a - b);
        return arr.length % 2 !== 0 ? nums[mid] : (nums[mid - 1] + nums[mid]) / 2;
    }
    /**
     * Calculates the mode values of an array of numbers.
     * @param arr - The array of numbers.
     */
    static mode(arr) {
        const frequencyMap = {};
        let maxFrequency = 0;
        arr.forEach((num) => {
            frequencyMap[num] = (frequencyMap[num] || 0) + 1;
            maxFrequency = Math.max(maxFrequency, frequencyMap[num]);
        });
        const modeValues = [];
        for (const num in frequencyMap) {
            if (frequencyMap[num] === maxFrequency) {
                modeValues.push(+num);
            }
        }
        return modeValues;
    }
    /**
     * Calculates the mean value of an array of numbers.
     * @param arr - The array of numbers.
     */
    static arithmeticMean(arr) {
        const sum = arr.reduce((acc, num) => acc + num, 0);
        return sum / arr.length;
    }
    /**
     * Calculates the geometric mean of an array of numbers.
     * @param arr - The array of numbers.
     */
    static geometricMean(arr) {
        const product = arr.reduce((acc, num) => acc * num, 1);
        return this.round(Math.pow(product, 1 / arr.length), {
            decimalPlaces: 6,
        });
    }
    /**
     * Calculates the harmonic mean of an array of numbers.
     * @param arr - The array of numbers.
     */
    static harmonicMean(arr) {
        const reciprocalSum = arr.reduce((acc, num) => acc + 1 / num, 0);
        return arr.length / reciprocalSum;
    }
    /**
     * Returns the largest integer less than or equal to a given number.
     * @param value The input number.
     */
    static floor(value) {
        return Math.floor(value);
    }
    /**
     * Returns the smallest integer greater than or equal to a given number.
     * @param value The input number.
     */
    static ceil(value) {
        return Math.ceil(value);
    }
    /**
     * Rounds the given number to the nearest integer.
     * @param value - The number to be rounded.
     */
    static round(value, options) {
        if (options && options.decimalPlaces) {
            const multiplier = Math.pow(10, options.decimalPlaces);
            return Math.round(value * multiplier) / multiplier;
        }
        return Math.round(value);
    }
    /**
     * Returns the minimum value from an array of numbers.
     * @param arr The array of numbers.
     */
    static min(arr) {
        return Math.min(...arr);
    }
    /**
     * Returns the maximum value from an array of numbers.
     * @param arr The array of numbers.
     */
    static max(arr) {
        return Math.max(...arr);
    }
    /**
     * Returns the square root of a number.
     * @param value A number greater than or equal to 0.
     */
    static sqrt(value) {
        if (value < 0) {
            throw new Error("Input value must be greater than or equal to 0.");
        }
        return Math.sqrt(value);
    }
    /**
     * Calculates the nth Fibonacci number.
     * @param n - The position of the Fibonacci number to calculate.
     */
    static fibonacci(n) {
        if (n === 0 || n === 1) {
            return n;
        }
        return this.fibonacci(n - 1) + this.fibonacci(n - 2);
    }
    /**
     * Calculates the factorial of a given number.
     * @param n - The number to calculate the factorial for.
     */
    static factorial(n) {
        if (n === 0 || n === 1) {
            return 1;
        }
        return n * this.factorial(n - 1);
    }
    /**
     * Calculates the number of combinations for choosing r items from a total of n items.
     * @param n - The total number of items.
     * @param r - The number of items to be chosen.
     */
    static combinations(n, r) {
        if (r > n) {
            return 0;
        }
        const numerator = this.factorial(n);
        const denominator = this.factorial(r) * this.factorial(n - r);
        return numerator / denominator;
    }
    /**
     * Calculate the length of the vector from the origin to the point given by the coordinates
     * @param coordinates Array of coordinates
     * @returns
     */
    static hypot(coordinates) {
        return Math.hypot(...coordinates);
    }
    /**
     * Convert degrees to radians
     * @param degrees Degree value
     */
    static degreesToRadians(degrees) {
        return (degrees * Math.PI) / 180;
    }
    /**
     * Convert radians to degrees
     * @param radians Radians value
     */
    static radiansToDegrees(radians) {
        return (radians * 180) / Math.PI;
    }
    /**
     * Returns the natural logarithm (base e) of a number.
     * @param value The input number.
     */
    static log(value) {
        return Math.log(value);
    }
    /**
     * Returns the base-2 logarithm of a number.
     * @param value The input number.
     */
    static log2(value) {
        return Math.log2(value);
    }
    /**
     * Returns the base-10 logarithm of a number.
     * @param value The input number.
     */
    static log10(value) {
        return Math.log10(value);
    }
    /**
     * Returns 1 or -1, indicating the sign of the number passed as an argument, 0 for 0.
     * @param value The input number.
     */
    static sign(value) {
        return Math.sign(value);
    }
    /**
     * Returns the sine of a number in radians.
     * @param value A number representing an angle in radians.
     */
    static sin(value) {
        return Math.sin(value);
    }
    /**
     * Returns the cosine of a number in radians.
     * @param value A number representing an angle in radians.
     */
    static cos(value) {
        return Math.cos(value);
    }
    /**
     * Returns the tangent of a number in radians.
     * @param value A number representing an angle in radians.
     */
    static tan(value) {
        return Math.tan(value);
    }
    /**
     * Returns the inverse sine (in radians) of a number.
     * @param value A number between -1 and 1, inclusive, representing the angle's sine value.
     */
    static asin(value) {
        if (value < -1 || value > 1) {
            throw new Error("Input value must be between -1 and 1, inclusive.");
        }
        return Math.asin(value);
    }
    /**
     * Returns the inverse cosine (in radians) of a number.
     * @param value A number between -1 and 1, inclusive, representing the angle's cosine value.
     */
    static acos(value) {
        if (value < -1 || value > 1) {
            throw new Error("Input value must be between -1 and 1, inclusive.");
        }
        return Math.acos(value);
    }
    /**
     * Returns the inverse tangent (in radians) of a number.
     * @param value A number.
     */
    static atan(value) {
        return Math.atan(value);
    }
    /**
     * Returns the angle in the plane (in radians) between the positive x-axis and the ray from
     * (0, 0) to the point (x, y), for Math.atan2(y, x).
     * @param y The y coordinate of the point.
     * @param x The x coordinate of the point.
     */
    static atan2(y, x) {
        return Math.atan2(y, x);
    }
    /**
     * Calculates the secant of an angle (in radians).
     *
     * @param value The angle in radians.
     * @returns The secant value of the angle.
     */
    static sec(value) {
        return 1 / Math.cos(value);
    }
    /**
     * Calculates the cosecant of an angle (in radians).
     *
     * @param value The angle in radians.
     * @returns The cosecant value of the angle.
     */
    static csc(value) {
        return 1 / Math.sin(value);
    }
    /**
     * Calculates the cotangent of an angle (in radians).
     *
     * @param value The angle in radians.
     * @returns The cotangent value of the angle.
     */
    static cot(value) {
        return 1 / Math.tan(value);
    }
    /**
     * Calculates the inverse secant (asec) of a number.
     *
     * @param value A number equal or greater than |1|, representing the secant value.
     * @returns The inverse secant (asec) in radians.
     */
    static asec(value) {
        if (Math.abs(value) < 1) {
            throw new Error("Input value must be equal or greater than |1|.");
        }
        return Math.acos(1 / value);
    }
    /**
     * Calculates the inverse cosecant (acsc) of a number.
     *
     * @param value A number equal or greater than |1|, representing the cosecant value.
     * @returns The inverse cosecant (acsc) in radians.
     */
    static acsc(value) {
        if (Math.abs(value) < 1) {
            throw new Error("Input value must be equal or greater than |1|.");
        }
        return Math.asin(1 / value);
    }
    /**
     * Calculates the inverse cotangent (acot) of a number.
     *
     * @param value A number representing the cotangent value.
     * @returns The inverse cotangent (acot) in radians.
     */
    static acot(value) {
        return Math.atan(1 / value);
    }
    /**
     * Generates a pseudo-random number between 0 and max (default of 1).
     * @param max - The maximum value of the random number.
     * @returns A pseudo-random number between 0 and max.
     */
    static random(max) {
        return Math.random() * (max || 1);
    }
    /**
     * Convert a value to a new number base
     *
     * @param value The number to be converted
     * @param base The base of the new value
     * @returns A string representation of the new number
     */
    static toRadix(value, base) {
        return value.toString(base);
    }
    constructor() { }
}
exports.Util = Util;
_a = JSII_RTTI_SYMBOL_1;
Util[_a] = { fqn: "@winglang/sdk.math.Util", version: "0.0.0" };
/**
 * The mathematical constant representing the ratio of a circle's circumference to its diameter.
 */
Util.PI = Math.PI;
/**
 * The mathematical constant representing the ratio of a circle's circumference to the radius.
 */
Util.TAU = 2 * Math.PI;
/**
 * Euler's number, a mathematical constant approximately equal to 2.71828.
 */
Util.E = Math.E;
/**
 * Positive infinity constant
 */
Util.INF = Number.POSITIVE_INFINITY;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWF0aC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9tYXRoL21hdGgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxrQ0FBeUM7QUFZekM7O0dBRUc7QUFDSCxNQUFhLElBQUk7SUFrQmY7O09BRUc7SUFDSSxNQUFNLENBQUMsZUFBZTtRQUMzQixPQUFPLHFCQUFjLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDdkQsQ0FBQztJQUVEOzs7T0FHRztJQUNJLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBUztRQUM3QixJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztZQUNYLE9BQU8sS0FBSyxDQUFDO1FBQ2YsQ0FBQztRQUNELEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7WUFDdkMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO2dCQUNoQixPQUFPLEtBQUssQ0FBQztZQUNmLENBQUM7UUFDSCxDQUFDO1FBQ0QsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFhO1FBQzdCLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN6QixDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksTUFBTSxDQUFDLE1BQU0sQ0FBQyxHQUFhO1FBQ2hDLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQztRQUN2QyxNQUFNLElBQUksR0FBRyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxH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QUFDLElBQUksQ0FBQyxLQUFhO1FBQzlCLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUMxQixDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFhO1FBQy9CLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUMzQixDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFhO1FBQzlCLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUMxQixDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFhO1FBQzdCLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN6QixDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFhO1FBQzdCLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN6QixDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFhO1FBQzdCLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN6QixDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFhO1FBQzlCLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQyxJQUFJLEtBQUssR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUM1QixNQUFNLElBQUksS0FBSyxDQUFDLGtEQUFrRCxDQUFDLENBQUM7UUFDdEUsQ0FBQztRQUNELE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUMxQixDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFhO1FBQzlCLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQyxJQUFJLEtBQUssR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUM1QixNQUFNLElBQUksS0FBSyxDQUFDLGtEQUFrRCxDQUFDLENBQUM7UUFDdEUsQ0FBQztRQUNELE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUMxQixDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFhO1FBQzlCLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUMxQixDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSSxNQUFNLENBQUMsS0FBSyxDQUFDLENBQVMsRUFBRSxDQUFTO1FBQ3RDLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDMUIsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFhO1FBQzdCLE9BQU8sQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDN0IsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFhO1FBQzdCLE9BQU8sQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDN0IsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFhO1FBQzdCLE9BQU8sQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDN0IsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ksTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFhO1FBQzlCLElBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUN4QixNQUFNLElBQUksS0FBSyxDQUFDLGdEQUFnRCxDQUFDLENBQUM7UUFDcEUsQ0FBQztRQUNELE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUM7SUFDOUIsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ksTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFhO1FBQzlCLElBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUN4QixNQUFNLElBQUksS0FBSyxDQUFDLGdEQUFnRCxDQUFDLENBQUM7UUFDcEUsQ0FBQztRQUNELE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUM7SUFDOUIsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ksTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFhO1FBQzlCLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUM7SUFDOUIsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQXVCO1FBQzFDLE9BQU8sSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUFFRDs7Ozs7O09BTUc7SUFDSSxNQUFNLENBQUMsT0FBTyxDQUFDLEtBQWEsRUFBRSxJQUFZO1FBQy9DLE9BQU8sS0FBSyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUM5QixDQUFDO0lBRUQsZ0JBQXVCLENBQUM7O0FBMVoxQixvQkEyWkM7OztBQTFaQzs7R0FFRztBQUNvQixPQUFFLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQztBQUNwQzs7R0FFRztBQUNvQixRQUFHLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUM7QUFDekM7O0dBRUc7QUFDb0IsTUFBQyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDbEM7O0dBRUc7QUFDb0IsUUFBRyxHQUFHLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluZmxpZ2h0Q2xpZW50IH0gZnJvbSBcIi4uL2NvcmVcIjtcblxuLyoqXG4gKiBPcHRpb25zIGZvciByb3VuZGluZyBhIG51bWJlci5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBSb3VuZGluZ09wdGlvbnMge1xuICAvKipcbiAgICogVGhlIG51bWJlciBvZiBkZWNpbWFsIHBsYWNlcyB0byByb3VuZCB0by5cbiAgICovXG4gIHJlYWRvbmx5IGRlY2ltYWxQbGFjZXM/OiBudW1iZXI7XG59XG5cbi8qKlxuICogVXRpbGl0eSBjbGFzcyBmb3IgbWF0aGVtYXRpY2FsIG9wZXJhdGlvbnMuXG4gKi9cbmV4cG9ydCBjbGFzcyBVdGlsIHtcbiAgLyoqXG4gICAqIFRoZSBtYXRoZW1hdGljYWwgY29uc3RhbnQgcmVwcmVzZW50aW5nIHRoZSByYXRpbyBvZiBhIGNpcmNsZSdzIGNpcmN1bWZlcmVuY2UgdG8gaXRzIGRpYW1ldGVyLlxuICAgKi9cbiAgcHVibGljIHN0YXRpYyByZWFkb25seSBQSSA9IE1hdGguUEk7XG4gIC8qKlxuICAgKiBUaGUgbWF0aGVtYXRpY2FsIGNvbnN0YW50IHJlcHJlc2VudGluZyB0aGUgcmF0aW8gb2YgYSBjaXJjbGUncyBjaXJjdW1mZXJlbmNlIHRvIHRoZSByYWRpdXMuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFRBVSA9IDIgKiBNYXRoLlBJO1xuICAvKipcbiAgICogRXVsZXIncyBudW1iZXIsIGEgbWF0aGVtYXRpY2FsIGNvbnN0YW50IGFwcHJveGltYXRlbHkgZXF1YWwgdG8gMi43MTgyOC5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgRSA9IE1hdGguRTtcbiAgLyoqXG4gICAqIFBvc2l0aXZlIGluZmluaXR5IGNvbnN0YW50XG4gICAqL1xuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IElORiA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWTtcblxuICAvKipcbiAgICogQGludGVybmFsXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIF90b0luZmxpZ2h0VHlwZSgpOiBzdHJpbmcge1xuICAgIHJldHVybiBJbmZsaWdodENsaWVudC5mb3JUeXBlKF9fZmlsZW5hbWUsIHRoaXMubmFtZSk7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIGEgbnVtYmVyIGlzIHByaW1lLlxuICAgKiBAcGFyYW0gbiBUaGUgbnVtYmVyIHRvIGNoZWNrIGZvciBwcmltYWxpdHkuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGlzUHJpbWUobjogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgaWYgKG4gPD0gMSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBmb3IgKGxldCBpID0gMjsgaSA8PSBNYXRoLnNxcnQobik7IGkrKykge1xuICAgICAgaWYgKG4gJSBpID09PSAwKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgYWJzb2x1dGUgdmFsdWUgb2YgYSBudW1iZXIuXG4gICAqIEBwYXJhbSB2YWx1ZSBUaGUgaW5wdXQgbnVtYmVyLlxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBhYnModmFsdWU6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIE1hdGguYWJzKHZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGVzIHRoZSBtZWRpYW4gdmFsdWUgb2YgYW4gYXJyYXkgb2YgbnVtYmVycy5cbiAgICogQHBhcmFtIGFyciAtIFRoZSBhcnJheSBvZiBudW1iZXJzLlxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBtZWRpYW4oYXJyOiBudW1iZXJbXSk6IG51bWJlciB7XG4gICAgY29uc3QgbWlkID0gTWF0aC5mbG9vcihhcnIubGVuZ3RoIC8gMik7XG4gICAgY29uc3QgbnVtcyA9IFsuLi5hcnJdLnNvcnQoKGEsIGIpID0+IGEgLSBiKTtcbiAgICByZXR1cm4gYXJyLmxlbmd0aCAlIDIgIT09IDAgPyBudW1zW21pZF0gOiAobnVtc1ttaWQgLSAxXSArIG51bXNbbWlkXSkgLyAyO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZXMgdGhlIG1vZGUgdmFsdWVzIG9mIGFuIGFycmF5IG9mIG51bWJlcnMuXG4gICAqIEBwYXJhbSBhcnIgLSBUaGUgYXJyYXkgb2YgbnVtYmVycy5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgbW9kZShhcnI6IG51bWJlcltdKTogbnVtYmVyW10ge1xuICAgIGNvbnN0IGZyZXF1ZW5jeU1hcDogUmVjb3JkPG51bWJlciwgbnVtYmVyPiA9IHt9O1xuICAgIGxldCBtYXhGcmVxdWVuY3kgPSAwO1xuXG4gICAgYXJyLmZvckVhY2goKG51bSkgPT4ge1xuICAgICAgZnJlcXVlbmN5TWFwW251bV0gPSAoZnJlcXVlbmN5TWFwW251bV0gfHwgMCkgKyAxO1xuICAgICAgbWF4RnJlcXVlbmN5ID0gTWF0aC5tYXgobWF4RnJlcXVlbmN5LCBmcmVxdWVuY3lNYXBbbnVtXSk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBtb2RlVmFsdWVzOiBudW1iZXJbXSA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBudW0gaW4gZnJlcXVlbmN5TWFwKSB7XG4gICAgICBpZiAoZnJlcXVlbmN5TWFwW251bV0gPT09IG1heEZyZXF1ZW5jeSkge1xuICAgICAgICBtb2RlVmFsdWVzLnB1c2goK251bSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG1vZGVWYWx1ZXM7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlcyB0aGUgbWVhbiB2YWx1ZSBvZiBhbiBhcnJheSBvZiBudW1iZXJzLlxuICAgKiBAcGFyYW0gYXJyIC0gVGhlIGFycmF5IG9mIG51bWJlcnMuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGFyaXRobWV0aWNNZWFuKGFycjogbnVtYmVyW10pOiBudW1iZXIge1xuICAgIGNvbnN0IHN1bSA9IGFyci5yZWR1Y2UoKGFjYywgbnVtKSA9PiBhY2MgKyBudW0sIDApO1xuICAgIHJldHVybiBzdW0gLyBhcnIubGVuZ3RoO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZXMgdGhlIGdlb21ldHJpYyBtZWFuIG9mIGFuIGFycmF5IG9mIG51bWJlcnMuXG4gICAqIEBwYXJhbSBhcnIgLSBUaGUgYXJyYXkgb2YgbnVtYmVycy5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZ2VvbWV0cmljTWVhbihhcnI6IG51bWJlcltdKTogbnVtYmVyIHtcbiAgICBjb25zdCBwcm9kdWN0ID0gYXJyLnJlZHVjZSgoYWNjLCBudW0pID0+IGFjYyAqIG51bSwgMSk7XG4gICAgcmV0dXJuIHRoaXMucm91bmQoTWF0aC5wb3cocHJvZHVjdCwgMSAvIGFyci5sZW5ndGgpLCB7XG4gICAgICBkZWNpbWFsUGxhY2VzOiA2LFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZXMgdGhlIGhhcm1vbmljIG1lYW4gb2YgYW4gYXJyYXkgb2YgbnVtYmVycy5cbiAgICogQHBhcmFtIGFyciAtIFRoZSBhcnJheSBvZiBudW1iZXJzLlxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBoYXJtb25pY01lYW4oYXJyOiBudW1iZXJbXSk6IG51bWJlciB7XG4gICAgY29uc3QgcmVjaXByb2NhbFN1bSA9IGFyci5yZWR1Y2UoKGFjYywgbnVtKSA9PiBhY2MgKyAxIC8gbnVtLCAwKTtcbiAgICByZXR1cm4gYXJyLmxlbmd0aCAvIHJlY2lwcm9jYWxTdW07XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgbGFyZ2VzdCBpbnRlZ2VyIGxlc3MgdGhhbiBvciBlcXVhbCB0byBhIGdpdmVuIG51bWJlci5cbiAgICogQHBhcmFtIHZhbHVlIFRoZSBpbnB1dCBudW1iZXIuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGZsb29yKHZhbHVlOiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiBNYXRoLmZsb29yKHZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBzbWFsbGVzdCBpbnRlZ2VyIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byBhIGdpdmVuIG51bWJlci5cbiAgICogQHBhcmFtIHZhbHVlIFRoZSBpbnB1dCBudW1iZXIuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGNlaWwodmFsdWU6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIE1hdGguY2VpbCh2YWx1ZSk7XG4gIH1cblxuICAvKipcbiAgICogUm91bmRzIHRoZSBnaXZlbiBudW1iZXIgdG8gdGhlIG5lYXJlc3QgaW50ZWdlci5cbiAgICogQHBhcmFtIHZhbHVlIC0gVGhlIG51bWJlciB0byBiZSByb3VuZGVkLlxuICAgKi9cbiAgcHVibGljIHN0YXRpYyByb3VuZCh2YWx1ZTogbnVtYmVyLCBvcHRpb25zPzogUm91bmRpbmdPcHRpb25zKTogbnVtYmVyIHtcbiAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmRlY2ltYWxQbGFjZXMpIHtcbiAgICAgIGNvbnN0IG11bHRpcGxpZXIgPSBNYXRoLnBvdygxMCwgb3B0aW9ucy5kZWNpbWFsUGxhY2VzKTtcbiAgICAgIHJldHVybiBNYXRoLnJvdW5kKHZhbHVlICogbXVsdGlwbGllcikgLyBtdWx0aXBsaWVyO1xuICAgIH1cbiAgICByZXR1cm4gTWF0aC5yb3VuZCh2YWx1ZSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgbWluaW11bSB2YWx1ZSBmcm9tIGFuIGFycmF5IG9mIG51bWJlcnMuXG4gICAqIEBwYXJhbSBhcnIgVGhlIGFycmF5IG9mIG51bWJlcnMuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIG1pbihhcnI6IG51bWJlcltdKTogbnVtYmVyIHtcbiAgICByZXR1cm4gTWF0aC5taW4oLi4uYXJyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBtYXhpbXVtIHZhbHVlIGZyb20gYW4gYXJyYXkgb2YgbnVtYmVycy5cbiAgICogQHBhcmFtIGFyciBUaGUgYXJyYXkgb2YgbnVtYmVycy5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgbWF4KGFycjogbnVtYmVyW10pOiBudW1iZXIge1xuICAgIHJldHVybiBNYXRoLm1heCguLi5hcnIpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIHNxdWFyZSByb290IG9mIGEgbnVtYmVyLlxuICAgKiBAcGFyYW0gdmFsdWUgQSBudW1iZXIgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIDAuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIHNxcnQodmFsdWU6IG51bWJlcik6IG51bWJlciB7XG4gICAgaWYgKHZhbHVlIDwgMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5wdXQgdmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gMC5cIik7XG4gICAgfVxuICAgIHJldHVybiBNYXRoLnNxcnQodmFsdWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZXMgdGhlIG50aCBGaWJvbmFjY2kgbnVtYmVyLlxuICAgKiBAcGFyYW0gbiAtIFRoZSBwb3NpdGlvbiBvZiB0aGUgRmlib25hY2NpIG51bWJlciB0byBjYWxjdWxhdGUuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGZpYm9uYWNjaShuOiBudW1iZXIpOiBudW1iZXIge1xuICAgIGlmIChuID09PSAwIHx8IG4gPT09IDEpIHtcbiAgICAgIHJldHVybiBuO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5maWJvbmFjY2kobiAtIDEpICsgdGhpcy5maWJvbmFjY2kobiAtIDIpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZXMgdGhlIGZhY3RvcmlhbCBvZiBhIGdpdmVuIG51bWJlci5cbiAgICogQHBhcmFtIG4gLSBUaGUgbnVtYmVyIHRvIGNhbGN1bGF0ZSB0aGUgZmFjdG9yaWFsIGZvci5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZmFjdG9yaWFsKG46IG51bWJlcik6IG51bWJlciB7XG4gICAgaWYgKG4gPT09IDAgfHwgbiA9PT0gMSkge1xuICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIHJldHVybiBuICogdGhpcy5mYWN0b3JpYWwobiAtIDEpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZXMgdGhlIG51bWJlciBvZiBjb21iaW5hdGlvbnMgZm9yIGNob29zaW5nIHIgaXRlbXMgZnJvbSBhIHRvdGFsIG9mIG4gaXRlbXMuXG4gICAqIEBwYXJhbSBuIC0gVGhlIHRvdGFsIG51bWJlciBvZiBpdGVtcy5cbiAgICogQHBhcmFtIHIgLSBUaGUgbnVtYmVyIG9mIGl0ZW1zIHRvIGJlIGNob3Nlbi5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgY29tYmluYXRpb25zKG46IG51bWJlciwgcjogbnVtYmVyKTogbnVtYmVyIHtcbiAgICBpZiAociA+IG4pIHtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBjb25zdCBudW1lcmF0b3IgPSB0aGlzLmZhY3RvcmlhbChuKTtcbiAgICBjb25zdCBkZW5vbWluYXRvciA9IHRoaXMuZmFjdG9yaWFsKHIpICogdGhpcy5mYWN0b3JpYWwobiAtIHIpO1xuICAgIHJldHVybiBudW1lcmF0b3IgLyBkZW5vbWluYXRvcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGUgdGhlIGxlbmd0aCBvZiB0aGUgdmVjdG9yIGZyb20gdGhlIG9yaWdpbiB0byB0aGUgcG9pbnQgZ2l2ZW4gYnkgdGhlIGNvb3JkaW5hdGVzXG4gICAqIEBwYXJhbSBjb29yZGluYXRlcyBBcnJheSBvZiBjb29yZGluYXRlc1xuICAgKiBAcmV0dXJuc1xuICAgKi9cbiAgcHVibGljIHN0YXRpYyBoeXBvdChjb29yZGluYXRlczogbnVtYmVyW10pOiBudW1iZXIge1xuICAgIHJldHVybiBNYXRoLmh5cG90KC4uLmNvb3JkaW5hdGVzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0IGRlZ3JlZXMgdG8gcmFkaWFuc1xuICAgKiBAcGFyYW0gZGVncmVlcyBEZWdyZWUgdmFsdWVcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgZGVncmVlc1RvUmFkaWFucyhkZWdyZWVzOiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiAoZGVncmVlcyAqIE1hdGguUEkpIC8gMTgwO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgcmFkaWFucyB0byBkZWdyZWVzXG4gICAqIEBwYXJhbSByYWRpYW5zIFJhZGlhbnMgdmFsdWVcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgcmFkaWFuc1RvRGVncmVlcyhyYWRpYW5zOiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiAocmFkaWFucyAqIDE4MCkgLyBNYXRoLlBJO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIG5hdHVyYWwgbG9nYXJpdGhtIChiYXNlIGUpIG9mIGEgbnVtYmVyLlxuICAgKiBAcGFyYW0gdmFsdWUgVGhlIGlucHV0IG51bWJlci5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgbG9nKHZhbHVlOiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiBNYXRoLmxvZyh2YWx1ZSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgYmFzZS0yIGxvZ2FyaXRobSBvZiBhIG51bWJlci5cbiAgICogQHBhcmFtIHZhbHVlIFRoZSBpbnB1dCBudW1iZXIuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGxvZzIodmFsdWU6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIE1hdGgubG9nMih2YWx1ZSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgYmFzZS0xMCBsb2dhcml0aG0gb2YgYSBudW1iZXIuXG4gICAqIEBwYXJhbSB2YWx1ZSBUaGUgaW5wdXQgbnVtYmVyLlxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBsb2cxMCh2YWx1ZTogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gTWF0aC5sb2cxMCh2YWx1ZSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyAxIG9yIC0xLCBpbmRpY2F0aW5nIHRoZSBzaWduIG9mIHRoZSBudW1iZXIgcGFzc2VkIGFzIGFuIGFyZ3VtZW50LCAwIGZvciAwLlxuICAgKiBAcGFyYW0gdmFsdWUgVGhlIGlucHV0IG51bWJlci5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgc2lnbih2YWx1ZTogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gTWF0aC5zaWduKHZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBzaW5lIG9mIGEgbnVtYmVyIGluIHJhZGlhbnMuXG4gICAqIEBwYXJhbSB2YWx1ZSBBIG51bWJlciByZXByZXNlbnRpbmcgYW4gYW5nbGUgaW4gcmFkaWFucy5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgc2luKHZhbHVlOiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiBNYXRoLnNpbih2YWx1ZSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgY29zaW5lIG9mIGEgbnVtYmVyIGluIHJhZGlhbnMuXG4gICAqIEBwYXJhbSB2YWx1ZSBBIG51bWJlciByZXByZXNlbnRpbmcgYW4gYW5nbGUgaW4gcmFkaWFucy5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgY29zKHZhbHVlOiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiBNYXRoLmNvcyh2YWx1ZSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgdGFuZ2VudCBvZiBhIG51bWJlciBpbiByYWRpYW5zLlxuICAgKiBAcGFyYW0gdmFsdWUgQSBudW1iZXIgcmVwcmVzZW50aW5nIGFuIGFuZ2xlIGluIHJhZGlhbnMuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIHRhbih2YWx1ZTogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gTWF0aC50YW4odmFsdWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGludmVyc2Ugc2luZSAoaW4gcmFkaWFucykgb2YgYSBudW1iZXIuXG4gICAqIEBwYXJhbSB2YWx1ZSBBIG51bWJlciBiZXR3ZWVuIC0xIGFuZCAxLCBpbmNsdXNpdmUsIHJlcHJlc2VudGluZyB0aGUgYW5nbGUncyBzaW5lIHZhbHVlLlxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBhc2luKHZhbHVlOiBudW1iZXIpOiBudW1iZXIge1xuICAgIGlmICh2YWx1ZSA8IC0xIHx8IHZhbHVlID4gMSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5wdXQgdmFsdWUgbXVzdCBiZSBiZXR3ZWVuIC0xIGFuZCAxLCBpbmNsdXNpdmUuXCIpO1xuICAgIH1cbiAgICByZXR1cm4gTWF0aC5hc2luKHZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBpbnZlcnNlIGNvc2luZSAoaW4gcmFkaWFucykgb2YgYSBudW1iZXIuXG4gICAqIEBwYXJhbSB2YWx1ZSBBIG51bWJlciBiZXR3ZWVuIC0xIGFuZCAxLCBpbmNsdXNpdmUsIHJlcHJlc2VudGluZyB0aGUgYW5nbGUncyBjb3NpbmUgdmFsdWUuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGFjb3ModmFsdWU6IG51bWJlcik6IG51bWJlciB7XG4gICAgaWYgKHZhbHVlIDwgLTEgfHwgdmFsdWUgPiAxKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnB1dCB2YWx1ZSBtdXN0IGJlIGJldHdlZW4gLTEgYW5kIDEsIGluY2x1c2l2ZS5cIik7XG4gICAgfVxuICAgIHJldHVybiBNYXRoLmFjb3ModmFsdWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGludmVyc2UgdGFuZ2VudCAoaW4gcmFkaWFucykgb2YgYSBudW1iZXIuXG4gICAqIEBwYXJhbSB2YWx1ZSBBIG51bWJlci5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgYXRhbih2YWx1ZTogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gTWF0aC5hdGFuKHZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBhbmdsZSBpbiB0aGUgcGxhbmUgKGluIHJhZGlhbnMpIGJldHdlZW4gdGhlIHBvc2l0aXZlIHgtYXhpcyBhbmQgdGhlIHJheSBmcm9tXG4gICAqICgwLCAwKSB0byB0aGUgcG9pbnQgKHgsIHkpLCBmb3IgTWF0aC5hdGFuMih5LCB4KS5cbiAgICogQHBhcmFtIHkgVGhlIHkgY29vcmRpbmF0ZSBvZiB0aGUgcG9pbnQuXG4gICAqIEBwYXJhbSB4IFRoZSB4IGNvb3JkaW5hdGUgb2YgdGhlIHBvaW50LlxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBhdGFuMih5OiBudW1iZXIsIHg6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIE1hdGguYXRhbjIoeSwgeCk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlcyB0aGUgc2VjYW50IG9mIGFuIGFuZ2xlIChpbiByYWRpYW5zKS5cbiAgICpcbiAgICogQHBhcmFtIHZhbHVlIFRoZSBhbmdsZSBpbiByYWRpYW5zLlxuICAgKiBAcmV0dXJucyBUaGUgc2VjYW50IHZhbHVlIG9mIHRoZSBhbmdsZS5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgc2VjKHZhbHVlOiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiAxIC8gTWF0aC5jb3ModmFsdWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZXMgdGhlIGNvc2VjYW50IG9mIGFuIGFuZ2xlIChpbiByYWRpYW5zKS5cbiAgICpcbiAgICogQHBhcmFtIHZhbHVlIFRoZSBhbmdsZSBpbiByYWRpYW5zLlxuICAgKiBAcmV0dXJucyBUaGUgY29zZWNhbnQgdmFsdWUgb2YgdGhlIGFuZ2xlLlxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBjc2ModmFsdWU6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIDEgLyBNYXRoLnNpbih2YWx1ZSk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlcyB0aGUgY290YW5nZW50IG9mIGFuIGFuZ2xlIChpbiByYWRpYW5zKS5cbiAgICpcbiAgICogQHBhcmFtIHZhbHVlIFRoZSBhbmdsZSBpbiByYWRpYW5zLlxuICAgKiBAcmV0dXJucyBUaGUgY290YW5nZW50IHZhbHVlIG9mIHRoZSBhbmdsZS5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgY290KHZhbHVlOiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiAxIC8gTWF0aC50YW4odmFsdWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZXMgdGhlIGludmVyc2Ugc2VjYW50IChhc2VjKSBvZiBhIG51bWJlci5cbiAgICpcbiAgICogQHBhcmFtIHZhbHVlIEEgbnVtYmVyIGVxdWFsIG9yIGdyZWF0ZXIgdGhhbiB8MXwsIHJlcHJlc2VudGluZyB0aGUgc2VjYW50IHZhbHVlLlxuICAgKiBAcmV0dXJucyBUaGUgaW52ZXJzZSBzZWNhbnQgKGFzZWMpIGluIHJhZGlhbnMuXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIGFzZWModmFsdWU6IG51bWJlcik6IG51bWJlciB7XG4gICAgaWYgKE1hdGguYWJzKHZhbHVlKSA8IDEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIklucHV0IHZhbHVlIG11c3QgYmUgZXF1YWwgb3IgZ3JlYXRlciB0aGFuIHwxfC5cIik7XG4gICAgfVxuICAgIHJldHVybiBNYXRoLmFjb3MoMSAvIHZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGVzIHRoZSBpbnZlcnNlIGNvc2VjYW50IChhY3NjKSBvZiBhIG51bWJlci5cbiAgICpcbiAgICogQHBhcmFtIHZhbHVlIEEgbnVtYmVyIGVxdWFsIG9yIGdyZWF0ZXIgdGhhbiB8MXwsIHJlcHJlc2VudGluZyB0aGUgY29zZWNhbnQgdmFsdWUuXG4gICAqIEByZXR1cm5zIFRoZSBpbnZlcnNlIGNvc2VjYW50IChhY3NjKSBpbiByYWRpYW5zLlxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBhY3NjKHZhbHVlOiBudW1iZXIpOiBudW1iZXIge1xuICAgIGlmIChNYXRoLmFicyh2YWx1ZSkgPCAxKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnB1dCB2YWx1ZSBtdXN0IGJlIGVxdWFsIG9yIGdyZWF0ZXIgdGhhbiB8MXwuXCIpO1xuICAgIH1cbiAgICByZXR1cm4gTWF0aC5hc2luKDEgLyB2YWx1ZSk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlcyB0aGUgaW52ZXJzZSBjb3RhbmdlbnQgKGFjb3QpIG9mIGEgbnVtYmVyLlxuICAgKlxuICAgKiBAcGFyYW0gdmFsdWUgQSBudW1iZXIgcmVwcmVzZW50aW5nIHRoZSBjb3RhbmdlbnQgdmFsdWUuXG4gICAqIEByZXR1cm5zIFRoZSBpbnZlcnNlIGNvdGFuZ2VudCAoYWNvdCkgaW4gcmFkaWFucy5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgYWNvdCh2YWx1ZTogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gTWF0aC5hdGFuKDEgLyB2YWx1ZSk7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGVzIGEgcHNldWRvLXJhbmRvbSBudW1iZXIgYmV0d2VlbiAwIGFuZCBtYXggKGRlZmF1bHQgb2YgMSkuXG4gICAqIEBwYXJhbSBtYXggLSBUaGUgbWF4aW11bSB2YWx1ZSBvZiB0aGUgcmFuZG9tIG51bWJlci5cbiAgICogQHJldHVybnMgQSBwc2V1ZG8tcmFuZG9tIG51bWJlciBiZXR3ZWVuIDAgYW5kIG1heC5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgcmFuZG9tKG1heDogbnVtYmVyIHwgdW5kZWZpbmVkKTogbnVtYmVyIHtcbiAgICByZXR1cm4gTWF0aC5yYW5kb20oKSAqIChtYXggfHwgMSk7XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydCBhIHZhbHVlIHRvIGEgbmV3IG51bWJlciBiYXNlXG4gICAqXG4gICAqIEBwYXJhbSB2YWx1ZSBUaGUgbnVtYmVyIHRvIGJlIGNvbnZlcnRlZFxuICAgKiBAcGFyYW0gYmFzZSBUaGUgYmFzZSBvZiB0aGUgbmV3IHZhbHVlXG4gICAqIEByZXR1cm5zIEEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBuZXcgbnVtYmVyXG4gICAqL1xuICBwdWJsaWMgc3RhdGljIHRvUmFkaXgodmFsdWU6IG51bWJlciwgYmFzZTogbnVtYmVyKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoYmFzZSk7XG4gIH1cblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge31cbn1cbiJdfQ==