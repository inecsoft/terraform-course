"use strict";
var _a, _b;
Object.defineProperty(exports, "__esModule", { value: true });
exports.RedisClientBase = exports.RedisInflightMethods = exports.Redis = exports.REDIS_FQN = void 0;
const JSII_RTTI_SYMBOL_1 = Symbol.for("jsii.rtti");
const constants_1 = require("../constants");
const types_1 = require("../core/types");
const std_1 = require("../std");
/**
 * Global identifier for `Redis`.
 */
exports.REDIS_FQN = (0, constants_1.fqnForType)("ex.Redis");
/**
 * A cloud redis db.
 *
 * @inflight `@winglang/sdk.ex.IRedisClient`
 * @abstract
 */
class Redis extends std_1.Resource {
    constructor(scope, id) {
        if (new.target === Redis) {
            return std_1.Resource._newFromFactory(exports.REDIS_FQN, scope, id);
        }
        super(scope, id);
        std_1.Node.of(this).title = "Redis";
        std_1.Node.of(this).description = "A Redis server";
    }
    /** @internal */
    get _liftMap() {
        return {};
    }
}
exports.Redis = Redis;
_a = JSII_RTTI_SYMBOL_1;
Redis[_a] = { fqn: "@winglang/sdk.ex.Redis", version: "0.0.0" };
/**
 * List of inflight operations available for `Redis`.
 * @internal
 */
var RedisInflightMethods;
(function (RedisInflightMethods) {
    /** `Redis.url` */
    RedisInflightMethods["URL"] = "url";
    /** `Redis.set` */
    RedisInflightMethods["SET"] = "set";
    /** `Redis.get` */
    RedisInflightMethods["GET"] = "get";
    /** `Redis.hset` */
    RedisInflightMethods["HSET"] = "hset";
    /** `Redis.hget` */
    RedisInflightMethods["HGET"] = "hget";
    /** `Redis.sadd` */
    RedisInflightMethods["SADD"] = "sadd";
    /** `Redis.smembers` */
    RedisInflightMethods["SMEMBERS"] = "smembers";
    /** `Redis.del` */
    RedisInflightMethods["DEL"] = "del";
})(RedisInflightMethods || (exports.RedisInflightMethods = RedisInflightMethods = {}));
/**
 * Base class for `Redis` Client.
 */
class RedisClientBase {
    async set(key, value) {
        let redis = await this.rawClient();
        await redis.set(key, value);
    }
    async get(key) {
        let redis = await this.rawClient();
        let result = (await redis.get(key)) ?? undefined; // for wing to return nil
        return result;
    }
    async hset(key, field, value) {
        const redis = await this.rawClient();
        const result = await redis.hset(key, field, value);
        return result;
    }
    async hget(key, field) {
        const redis = await this.rawClient();
        const result = await redis.hget(key, field);
        return result;
    }
    async sadd(key, value) {
        const redis = await this.rawClient();
        const result = await redis.sadd(key, value);
        return result;
    }
    async smembers(key) {
        const redis = await this.rawClient();
        const result = await redis.smembers(key);
        return result ?? [];
    }
    async del(key) {
        const redis = await this.rawClient();
        const result = await redis.del(key);
        return result;
    }
}
exports.RedisClientBase = RedisClientBase;
_b = JSII_RTTI_SYMBOL_1;
RedisClientBase[_b] = { fqn: "@winglang/sdk.ex.RedisClientBase", version: "0.0.0" };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVkaXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvZXgvcmVkaXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFDQSw0Q0FBMEM7QUFFMUMseUNBQWdEO0FBQ2hELGdDQUF3QztBQUV4Qzs7R0FFRztBQUNVLFFBQUEsU0FBUyxHQUFHLElBQUEsc0JBQVUsRUFBQyxVQUFVLENBQUMsQ0FBQztBQUVoRDs7Ozs7R0FLRztBQUNILE1BQWEsS0FBTSxTQUFRLGNBQVE7SUFJakMsWUFBWSxLQUFnQixFQUFFLEVBQVU7UUFDdEMsSUFBSSxHQUFHLENBQUMsTUFBTSxLQUFLLEtBQUssRUFBRSxDQUFDO1lBQ3pCLE9BQU8sY0FBUSxDQUFDLGVBQWUsQ0FBQyxpQkFBUyxFQUFFLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQztRQUN4RCxDQUFDO1FBRUQsS0FBSyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQztRQUVqQixVQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssR0FBRyxPQUFPLENBQUM7UUFDOUIsVUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxXQUFXLEdBQUcsZ0JBQWdCLENBQUM7SUFDL0MsQ0FBQztJQUVELGdCQUFnQjtJQUNoQixJQUFXLFFBQVE7UUFDakIsT0FBTyxFQUFFLENBQUM7SUFDWixDQUFDOztBQWxCSCxzQkFtQkM7OztBQXdFRDs7O0dBR0c7QUFDSCxJQUFZLG9CQWlCWDtBQWpCRCxXQUFZLG9CQUFvQjtJQUM5QixrQkFBa0I7SUFDbEIsbUNBQVcsQ0FBQTtJQUNYLGtCQUFrQjtJQUNsQixtQ0FBVyxDQUFBO0lBQ1gsa0JBQWtCO0lBQ2xCLG1DQUFXLENBQUE7SUFDWCxtQkFBbUI7SUFDbkIscUNBQWEsQ0FBQTtJQUNiLG1CQUFtQjtJQUNuQixxQ0FBYSxDQUFBO0lBQ2IsbUJBQW1CO0lBQ25CLHFDQUFhLENBQUE7SUFDYix1QkFBdUI7SUFDdkIsNkNBQXFCLENBQUE7SUFDckIsa0JBQWtCO0lBQ2xCLG1DQUFXLENBQUE7QUFDYixDQUFDLEVBakJXLG9CQUFvQixvQ0FBcEIsb0JBQW9CLFFBaUIvQjtBQUVEOztHQUVHO0FBQ0gsTUFBc0IsZUFBZTtJQU81QixLQUFLLENBQUMsR0FBRyxDQUFDLEdBQVcsRUFBRSxLQUFhO1FBQ3pDLElBQUksS0FBSyxHQUFHLE1BQU0sSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBQ25DLE1BQU0sS0FBSyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDOUIsQ0FBQztJQUVNLEtBQUssQ0FBQyxHQUFHLENBQUMsR0FBVztRQUMxQixJQUFJLEtBQUssR0FBRyxNQUFNLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUNuQyxJQUFJLE1BQU0sR0FBRyxDQUFDLE1BQU0sS0FBSyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLFNBQVMsQ0FBQyxDQUFDLHlCQUF5QjtRQUMzRSxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0lBRU0sS0FBSyxDQUFDLElBQUksQ0FDZixHQUFXLEVBQ1gsS0FBYSxFQUNiLEtBQWE7UUFFYixNQUFNLEtBQUssR0FBRyxNQUFNLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUNyQyxNQUFNLE1BQU0sR0FBRyxNQUFNLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNuRCxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0lBRU0sS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFXLEVBQUUsS0FBYTtRQUMxQyxNQUFNLEtBQUssR0FBRyxNQUFNLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUNyQyxNQUFNLE1BQU0sR0FBRyxNQUFNLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQzVDLE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7SUFFTSxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQVcsRUFBRSxLQUFhO1FBQzFDLE1BQU0sS0FBSyxHQUFHLE1BQU0sSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBQ3JDLE1BQU0sTUFBTSxHQUFHLE1BQU0sS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDNUMsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQztJQUVNLEtBQUssQ0FBQyxRQUFRLENBQUMsR0FBVztRQUMvQixNQUFNLEtBQUssR0FBRyxNQUFNLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUNyQyxNQUFNLE1BQU0sR0FBRyxNQUFNLEtBQUssQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDekMsT0FBTyxNQUFNLElBQUksRUFBRSxDQUFDO0lBQ3RCLENBQUM7SUFFTSxLQUFLLENBQUMsR0FBRyxDQUFDLEdBQVc7UUFDMUIsTUFBTSxLQUFLLEdBQUcsTUFBTSxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDckMsTUFBTSxNQUFNLEdBQUcsTUFBTSxLQUFLLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3BDLE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7O0FBbERILDBDQW1EQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gXCJjb25zdHJ1Y3RzXCI7XG5pbXBvcnQgeyBmcW5Gb3JUeXBlIH0gZnJvbSBcIi4uL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgTGlmdE1hcCB9IGZyb20gXCIuLi9jb3JlXCI7XG5pbXBvcnQgeyBJTkZMSUdIVF9TWU1CT0wgfSBmcm9tIFwiLi4vY29yZS90eXBlc1wiO1xuaW1wb3J0IHsgTm9kZSwgUmVzb3VyY2UgfSBmcm9tIFwiLi4vc3RkXCI7XG5cbi8qKlxuICogR2xvYmFsIGlkZW50aWZpZXIgZm9yIGBSZWRpc2AuXG4gKi9cbmV4cG9ydCBjb25zdCBSRURJU19GUU4gPSBmcW5Gb3JUeXBlKFwiZXguUmVkaXNcIik7XG5cbi8qKlxuICogQSBjbG91ZCByZWRpcyBkYi5cbiAqXG4gKiBAaW5mbGlnaHQgYEB3aW5nbGFuZy9zZGsuZXguSVJlZGlzQ2xpZW50YFxuICogQGFic3RyYWN0XG4gKi9cbmV4cG9ydCBjbGFzcyBSZWRpcyBleHRlbmRzIFJlc291cmNlIHtcbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwdWJsaWMgW0lORkxJR0hUX1NZTUJPTF0/OiBJUmVkaXNDbGllbnQ7XG5cbiAgY29uc3RydWN0b3Ioc2NvcGU6IENvbnN0cnVjdCwgaWQ6IHN0cmluZykge1xuICAgIGlmIChuZXcudGFyZ2V0ID09PSBSZWRpcykge1xuICAgICAgcmV0dXJuIFJlc291cmNlLl9uZXdGcm9tRmFjdG9yeShSRURJU19GUU4sIHNjb3BlLCBpZCk7XG4gICAgfVxuXG4gICAgc3VwZXIoc2NvcGUsIGlkKTtcblxuICAgIE5vZGUub2YodGhpcykudGl0bGUgPSBcIlJlZGlzXCI7XG4gICAgTm9kZS5vZih0aGlzKS5kZXNjcmlwdGlvbiA9IFwiQSBSZWRpcyBzZXJ2ZXJcIjtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgcHVibGljIGdldCBfbGlmdE1hcCgpOiBMaWZ0TWFwIHtcbiAgICByZXR1cm4ge307XG4gIH1cbn1cblxuLyoqXG4gKiBJbmZsaWdodCBpbnRlcmZhY2UgZm9yIGBSZWRpc2AuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSVJlZGlzQ2xpZW50IHtcbiAgLyoqXG4gICAqIEdldCB1cmwgb2YgcmVkaXMgc2VydmVyLlxuICAgKiBAaW5mbGlnaHRcbiAgICovXG4gIHVybCgpOiBQcm9taXNlPHN0cmluZz47XG5cbiAgLyoqXG4gICAqIFNldCBrZXkgdmFsdWUgcGFpci5cbiAgICpcbiAgICogQHBhcmFtIGtleSB0aGUga2V5IHRvIHNldFxuICAgKiBAcGFyYW0gdmFsdWUgdGhlIHZhbHVlIHRvIHN0b3JlIGF0IGdpdmVuIGtleVxuICAgKiBAaW5mbGlnaHRcbiAgICovXG4gIHNldChrZXk6IHN0cmluZywgdmFsdWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD47XG5cbiAgLyoqXG4gICAqIEdldCB2YWx1ZSBhdCBnaXZlbiBrZXkuXG4gICAqIEBwYXJhbSBrZXkgdGhlIGtleSB0byBnZXRcbiAgICogQGluZmxpZ2h0XG4gICAqL1xuICBnZXQoa2V5OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZyB8IHVuZGVmaW5lZD47XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIHNwZWNpZmllZCBmaWVsZCB0byByZXNwZWN0aXZlIHZhbHVlIGluIHRoZSBoYXNoIHN0b3JlZCBhdCBrZXlcbiAgICpcbiAgICogQHBhcmFtIGtleSBrZXkgdG8gc2V0XG4gICAqIEBwYXJhbSBmaWVsZCBmaWVsZCBpbiBrZXkgdG8gc2V0XG4gICAqIEBwYXJhbSB2YWx1ZSB2YWx1ZSB0byBzZXQgYXQgZmllbGQgaW4ga2V5XG4gICAqIEBpbmZsaWdodFxuICAgKi9cbiAgaHNldChrZXk6IHN0cmluZywgZmllbGQ6IHN0cmluZywgdmFsdWU6IHN0cmluZyk6IFByb21pc2U8bnVtYmVyPjtcblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgdmFsdWUgYXNzb2NpYXRlZCB3aXRoIGZpZWxkIGluIHRoZSBoYXNoIHN0b3JlZCBhdCBrZXlcbiAgICpcbiAgICogQHBhcmFtIGtleSB0aGUga2V5XG4gICAqIEBwYXJhbSBmaWVsZCB0aGUgZmllbGQgYXQgZ2l2ZW4ga2V5XG4gICAqIEBpbmZsaWdodFxuICAgKi9cbiAgaGdldChrZXk6IHN0cmluZywgZmllbGQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nIHwgdW5kZWZpbmVkPjtcblxuICAvKipcbiAgICogQWRkIHRoZSBzcGVjaWZpZWQgbWVtYmVycyB0byB0aGUgc2V0IHN0b3JlZCBhdCBrZXlcbiAgICogQHBhcmFtIGtleSB0aGUga2V5XG4gICAqIEBwYXJhbSB2YWx1ZSB0aGUgdmFsdWUgdG8gYWRkIHRvIHRoZSBzZXQgYXQgZ2l2ZW4ga2V5XG4gICAqIEBpbmZsaWdodFxuICAgKi9cbiAgc2FkZChrZXk6IHN0cmluZywgdmFsdWU6IHN0cmluZyk6IFByb21pc2U8bnVtYmVyPjtcblxuICAvKipcbiAgICogUmV0dXJucyBhbGwgdGhlIG1lbWJlcnMgb2YgdGhlIHNldCB2YWx1ZSBzdG9yZWQgYXQga2V5XG4gICAqXG4gICAqIEBwYXJhbSBrZXkgdGhlIGtleVxuICAgKiBAaW5mbGlnaHRcbiAgICovXG4gIHNtZW1iZXJzKGtleTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmdbXT47XG5cbiAgLyoqXG4gICAqIFJlbW92ZXMgdGhlIHNwZWNpZmllZCBrZXlcbiAgICpcbiAgICogQHBhcmFtIGtleSB0aGUga2V5XG4gICAqIEBpbmZsaWdodFxuICAgKi9cbiAgZGVsKGtleTogc3RyaW5nKTogUHJvbWlzZTxudW1iZXI+O1xufVxuXG4vKipcbiAqIExpc3Qgb2YgaW5mbGlnaHQgb3BlcmF0aW9ucyBhdmFpbGFibGUgZm9yIGBSZWRpc2AuXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGVudW0gUmVkaXNJbmZsaWdodE1ldGhvZHMge1xuICAvKiogYFJlZGlzLnVybGAgKi9cbiAgVVJMID0gXCJ1cmxcIixcbiAgLyoqIGBSZWRpcy5zZXRgICovXG4gIFNFVCA9IFwic2V0XCIsXG4gIC8qKiBgUmVkaXMuZ2V0YCAqL1xuICBHRVQgPSBcImdldFwiLFxuICAvKiogYFJlZGlzLmhzZXRgICovXG4gIEhTRVQgPSBcImhzZXRcIixcbiAgLyoqIGBSZWRpcy5oZ2V0YCAqL1xuICBIR0VUID0gXCJoZ2V0XCIsXG4gIC8qKiBgUmVkaXMuc2FkZGAgKi9cbiAgU0FERCA9IFwic2FkZFwiLFxuICAvKiogYFJlZGlzLnNtZW1iZXJzYCAqL1xuICBTTUVNQkVSUyA9IFwic21lbWJlcnNcIixcbiAgLyoqIGBSZWRpcy5kZWxgICovXG4gIERFTCA9IFwiZGVsXCIsXG59XG5cbi8qKlxuICogQmFzZSBjbGFzcyBmb3IgYFJlZGlzYCBDbGllbnQuXG4gKi9cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBSZWRpc0NsaWVudEJhc2UgaW1wbGVtZW50cyBJUmVkaXNDbGllbnQge1xuICAvKipcbiAgICogR2V0IHJhdyByZWRpcyBjbGllbnQgKGN1cnJlbnRseSBJb1JlZGlzKS5cbiAgICovXG4gIHByb3RlY3RlZCBhYnN0cmFjdCByYXdDbGllbnQoKTogUHJvbWlzZTxhbnk+O1xuICBwdWJsaWMgYWJzdHJhY3QgdXJsKCk6IFByb21pc2U8c3RyaW5nPjtcblxuICBwdWJsaWMgYXN5bmMgc2V0KGtleTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgbGV0IHJlZGlzID0gYXdhaXQgdGhpcy5yYXdDbGllbnQoKTtcbiAgICBhd2FpdCByZWRpcy5zZXQoa2V5LCB2YWx1ZSk7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgZ2V0KGtleTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmcgfCB1bmRlZmluZWQ+IHtcbiAgICBsZXQgcmVkaXMgPSBhd2FpdCB0aGlzLnJhd0NsaWVudCgpO1xuICAgIGxldCByZXN1bHQgPSAoYXdhaXQgcmVkaXMuZ2V0KGtleSkpID8/IHVuZGVmaW5lZDsgLy8gZm9yIHdpbmcgdG8gcmV0dXJuIG5pbFxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgaHNldChcbiAgICBrZXk6IHN0cmluZyxcbiAgICBmaWVsZDogc3RyaW5nLFxuICAgIHZhbHVlOiBzdHJpbmdcbiAgKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBjb25zdCByZWRpcyA9IGF3YWl0IHRoaXMucmF3Q2xpZW50KCk7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVkaXMuaHNldChrZXksIGZpZWxkLCB2YWx1ZSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBoZ2V0KGtleTogc3RyaW5nLCBmaWVsZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmcgfCB1bmRlZmluZWQ+IHtcbiAgICBjb25zdCByZWRpcyA9IGF3YWl0IHRoaXMucmF3Q2xpZW50KCk7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVkaXMuaGdldChrZXksIGZpZWxkKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcHVibGljIGFzeW5jIHNhZGQoa2V5OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIGNvbnN0IHJlZGlzID0gYXdhaXQgdGhpcy5yYXdDbGllbnQoKTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZWRpcy5zYWRkKGtleSwgdmFsdWUpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBwdWJsaWMgYXN5bmMgc21lbWJlcnMoa2V5OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgY29uc3QgcmVkaXMgPSBhd2FpdCB0aGlzLnJhd0NsaWVudCgpO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlZGlzLnNtZW1iZXJzKGtleSk7XG4gICAgcmV0dXJuIHJlc3VsdCA/PyBbXTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBkZWwoa2V5OiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIGNvbnN0IHJlZGlzID0gYXdhaXQgdGhpcy5yYXdDbGllbnQoKTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZWRpcy5kZWwoa2V5KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG59XG4iXX0=