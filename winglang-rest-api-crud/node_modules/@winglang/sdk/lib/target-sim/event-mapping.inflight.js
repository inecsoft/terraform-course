"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.EventMapping = void 0;
const simulator_1 = require("../simulator/simulator");
class EventMapping {
    constructor(props) {
        this.publisher = props.publisher;
        this.subscriber = props.subscriber;
        this.eventSubscription = props.subscriptionProps;
    }
    get context() {
        if (!this._context) {
            throw new Error("Cannot access context during class construction");
        }
        return this._context;
    }
    async init(context) {
        this._context = context;
        const client = this.context.getClient(this.publisher, true);
        await client.addEventSubscription(this.subscriber, this.eventSubscription);
        return {};
    }
    async cleanup() {
        const client = this.context.getClient(this.publisher, true);
        await client.removeEventSubscription(this.subscriber);
    }
    async save() { }
    async plan() {
        return simulator_1.UpdatePlan.AUTO;
    }
}
exports.EventMapping = EventMapping;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXZlbnQtbWFwcGluZy5pbmZsaWdodC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90YXJnZXQtc2ltL2V2ZW50LW1hcHBpbmcuaW5mbGlnaHQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBUUEsc0RBQWdGO0FBRWhGLE1BQWEsWUFBWTtJQU12QixZQUFZLEtBQXlCO1FBQ25DLElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDLFNBQVMsQ0FBQztRQUNqQyxJQUFJLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQyxVQUFVLENBQUM7UUFDbkMsSUFBSSxDQUFDLGlCQUFpQixHQUFHLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQztJQUNuRCxDQUFDO0lBRUQsSUFBWSxPQUFPO1FBQ2pCLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDbkIsTUFBTSxJQUFJLEtBQUssQ0FBQyxpREFBaUQsQ0FBQyxDQUFDO1FBQ3JFLENBQUM7UUFDRCxPQUFPLElBQUksQ0FBQyxRQUFRLENBQUM7SUFDdkIsQ0FBQztJQUVNLEtBQUssQ0FBQyxJQUFJLENBQ2YsT0FBMEI7UUFFMUIsSUFBSSxDQUFDLFFBQVEsR0FBRyxPQUFPLENBQUM7UUFDeEIsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQ25DLElBQUksQ0FBQyxTQUFTLEVBQ2QsSUFBSSxDQUNjLENBQUM7UUFDckIsTUFBTSxNQUFNLENBQUMsb0JBQW9CLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQztRQUMzRSxPQUFPLEVBQUUsQ0FBQztJQUNaLENBQUM7SUFFTSxLQUFLLENBQUMsT0FBTztRQUNsQixNQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FDbkMsSUFBSSxDQUFDLFNBQVMsRUFDZCxJQUFJLENBQ2MsQ0FBQztRQUNyQixNQUFNLE1BQU0sQ0FBQyx1QkFBdUIsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDeEQsQ0FBQztJQUVNLEtBQUssQ0FBQyxJQUFJLEtBQW1CLENBQUM7SUFFOUIsS0FBSyxDQUFDLElBQUk7UUFDZixPQUFPLHNCQUFVLENBQUMsSUFBSSxDQUFDO0lBQ3pCLENBQUM7Q0FDRjtBQTVDRCxvQ0E0Q0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJRXZlbnRQdWJsaXNoZXIgfSBmcm9tIFwiLi9ldmVudC1tYXBwaW5nXCI7XG5pbXBvcnQge1xuICBFdmVudE1hcHBpbmdBdHRyaWJ1dGVzLFxuICBFdmVudE1hcHBpbmdTY2hlbWEsXG4gIEV2ZW50U3Vic2NyaXB0aW9uLFxuICBSZXNvdXJjZUhhbmRsZSxcbn0gZnJvbSBcIi4vc2NoZW1hLXJlc291cmNlc1wiO1xuaW1wb3J0IHsgSVNpbXVsYXRvckNvbnRleHQgfSBmcm9tIFwiLi4vc2ltdWxhdG9yXCI7XG5pbXBvcnQgeyBJU2ltdWxhdG9yUmVzb3VyY2VJbnN0YW5jZSwgVXBkYXRlUGxhbiB9IGZyb20gXCIuLi9zaW11bGF0b3Ivc2ltdWxhdG9yXCI7XG5cbmV4cG9ydCBjbGFzcyBFdmVudE1hcHBpbmcgaW1wbGVtZW50cyBJU2ltdWxhdG9yUmVzb3VyY2VJbnN0YW5jZSB7XG4gIHByaXZhdGUgcmVhZG9ubHkgcHVibGlzaGVyOiBSZXNvdXJjZUhhbmRsZTtcbiAgcHJpdmF0ZSByZWFkb25seSBzdWJzY3JpYmVyOiBSZXNvdXJjZUhhbmRsZTtcbiAgcHJpdmF0ZSByZWFkb25seSBldmVudFN1YnNjcmlwdGlvbjogRXZlbnRTdWJzY3JpcHRpb247XG4gIHByaXZhdGUgX2NvbnRleHQ6IElTaW11bGF0b3JDb250ZXh0IHwgdW5kZWZpbmVkO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBFdmVudE1hcHBpbmdTY2hlbWEpIHtcbiAgICB0aGlzLnB1Ymxpc2hlciA9IHByb3BzLnB1Ymxpc2hlcjtcbiAgICB0aGlzLnN1YnNjcmliZXIgPSBwcm9wcy5zdWJzY3JpYmVyO1xuICAgIHRoaXMuZXZlbnRTdWJzY3JpcHRpb24gPSBwcm9wcy5zdWJzY3JpcHRpb25Qcm9wcztcbiAgfVxuXG4gIHByaXZhdGUgZ2V0IGNvbnRleHQoKTogSVNpbXVsYXRvckNvbnRleHQge1xuICAgIGlmICghdGhpcy5fY29udGV4dCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGFjY2VzcyBjb250ZXh0IGR1cmluZyBjbGFzcyBjb25zdHJ1Y3Rpb25cIik7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9jb250ZXh0O1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGluaXQoXG4gICAgY29udGV4dDogSVNpbXVsYXRvckNvbnRleHRcbiAgKTogUHJvbWlzZTxFdmVudE1hcHBpbmdBdHRyaWJ1dGVzPiB7XG4gICAgdGhpcy5fY29udGV4dCA9IGNvbnRleHQ7XG4gICAgY29uc3QgY2xpZW50ID0gdGhpcy5jb250ZXh0LmdldENsaWVudChcbiAgICAgIHRoaXMucHVibGlzaGVyLFxuICAgICAgdHJ1ZVxuICAgICkgYXMgSUV2ZW50UHVibGlzaGVyO1xuICAgIGF3YWl0IGNsaWVudC5hZGRFdmVudFN1YnNjcmlwdGlvbih0aGlzLnN1YnNjcmliZXIsIHRoaXMuZXZlbnRTdWJzY3JpcHRpb24pO1xuICAgIHJldHVybiB7fTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBjbGVhbnVwKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNsaWVudCA9IHRoaXMuY29udGV4dC5nZXRDbGllbnQoXG4gICAgICB0aGlzLnB1Ymxpc2hlcixcbiAgICAgIHRydWVcbiAgICApIGFzIElFdmVudFB1Ymxpc2hlcjtcbiAgICBhd2FpdCBjbGllbnQucmVtb3ZlRXZlbnRTdWJzY3JpcHRpb24odGhpcy5zdWJzY3JpYmVyKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBzYXZlKCk6IFByb21pc2U8dm9pZD4ge31cblxuICBwdWJsaWMgYXN5bmMgcGxhbigpIHtcbiAgICByZXR1cm4gVXBkYXRlUGxhbi5BVVRPO1xuICB9XG59XG4iXX0=