"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const promises_1 = require("fs/promises");
const os_1 = require("os");
const path_1 = require("path");
const vitest_1 = require("vitest");
const env_1 = require("./env");
(0, vitest_1.test)("can load env file", async () => {
    const tempdir = await (0, promises_1.mkdtemp)((0, path_1.join)((0, os_1.tmpdir)(), "env-test"));
    const envFile = `${tempdir}/.env`;
    await (0, promises_1.writeFile)(envFile, "TEST1=1\nTEST2=2\n");
    const loaded = (0, env_1.loadEnvVariables)({
        cwd: tempdir,
    });
    (0, vitest_1.expect)(loaded).toBeDefined();
    (0, vitest_1.expect)(loaded.TEST1).toBe("1");
    (0, vitest_1.expect)(loaded.TEST2).toBe("2");
});
(0, vitest_1.test)("can load env file with expansion", async () => {
    const tempdir = await (0, promises_1.mkdtemp)((0, path_1.join)((0, os_1.tmpdir)(), "env-test"));
    const envFile = `${tempdir}/.env`;
    await (0, promises_1.writeFile)(envFile, "BASE_THING=hi\nOTHER_THING=${BASE_THING}_wing\n");
    const loaded = (0, env_1.loadEnvVariables)({
        cwd: tempdir,
    });
    (0, vitest_1.expect)(loaded).toBeDefined();
    (0, vitest_1.expect)(loaded.BASE_THING).toBe("hi");
    (0, vitest_1.expect)(loaded.OTHER_THING).toBe("hi_wing");
});
//# sourceMappingURL=env.test.js.map